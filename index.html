<head></head>
<body>
    <input id="pacakge" placeholder="package" oninput="templater.onPackageChange(this)">
    <input id="type" placeholder="type" oninput="templater.onTypeChange(this)">
    <pre id="code"></pre>
    <script>

        function generateCode(package, type) {
            return `
type ${type}Set map[${package}.${type}]struct{}

func (set ${type}Set) Add(tags ...${package}.${type}) {
    for _, tag := range tags {
        set[tag] = struct{}{}
    }
}

func (set ${type}Set) Remove(tags ...${package}.${type}) {
	for _, tag := range tags {
		delete(set, tag)
	}
}

func (set ${type}Set) Union(set2 ${type}Set) ${type}Set {
	set3 := make(${type}Set)
	set3.Add(set.Slice())
	set3.Add(set2.Slice())
	return set3
}

func (set ${type}Set) Or(set2 ${type}Set) ${type}set {
	return set.Union(set2)
}

func (set ${type}Set) Intersection(set2 ${type}Set) ${type}Set {
	set3 := make(${type}Set)
	for tag := range set2 {
		if t1.Contains(tag) {
			set3.Add(tag)
		}
	}
	return set3
}

// And returns a set set3 such that for each element in set3, this element is in both set and set2.
func (set ${type}Set) And(set2 ${type}Set) ${type}Set {
	return set.Intersection(set2)
}

func (set ${type}Set) Slice() []${package}.${type} {
	set2 := make([]${package}.${type}, len(set))
	i := 0
	for tag := range set {
		set2[i] = tag
		i++
	}
	return set2
}`
        }

        let templater = (function() {

            let pacakge = ""
            let type = ""

            return {
                // Expect a textarea element
                "onPackageChange": function(ele) {
                    package = ele.value
                    let code = generateCode(package, type)
                    let codeEle = document.getElementById("code")
                    codeEle.textContent = code
                },
                // Expect a textarea element
                "onTypeChange": function(ele) {
                    type = ele.value
                    let code = generateCode(package, type)
                    let codeEle = document.getElementById("code")
                    codeEle.textContent = code
                },
            }
        })()


    </script>
</body>